{% extends 'wtb_base.html' %}


{% load static %}
{% load my_replace %}


{% block title %} 嘩！找書 {% endblock %}
{% block js %} 
	<script>
		//店家名稱及代碼
		const stores_name=['博客來',
			{% for name in names %}
				'{{name}}',
			{% endfor %}		
		];

		const stores=['books',
			{% for store in stores %}
				'{{store}}',
			{% endfor %}		
		];

		//整理定價及售價
		const price_list={{book.info.price_list}};
		const bookprices=[
			{
				'store_name'      :stores_name[0],
				'store'           :stores[0],
				'price_sale'      :'{{book.info.price_sale}}',
				'price_sale_ebook':'{{book.info.price_sale_ebook}}',
				'url_book'        :'https://www.books.com.tw/products/{{book.info.bookid}}',
				'url_ebook'       :'{{book.info.bookid_ebook}}'!=''?'https://www.books.com.tw/products/{{book.info.bookid_ebook}}':''		
			},
			{% for bookprice in book.price %}				
				{
					'store_name'      :stores_name[stores.indexOf('{{bookprice.store}}')],
					'store'           :'{{bookprice.store}}',
					'price_sale'      :'{{bookprice.price_sale}}',
					'price_sale_ebook':'{{bookprice.price_sale_ebook}}',
					'url_book'        :'{{bookprice.url_book}}'.replace(/&amp;/g, '&'),//ORM出來會變$amp;
					'url_ebook'       :'{{bookprice.url_ebook}}'.replace(/&amp;/g, '&')			
				},				
			{% endfor %}			
		];
		//alert(JSON.stringify(bookprices));
		//
		

	</script>
	<script src='{% static "js/wtb_book.js" %}?v=2'></script>
{% endblock %}

{% block content %} 
	<div id='body_book' class='body' align='' style="">
		<div id='info'>
			<img id='cover' src='{{book.info.url_cover}}'>
			<div id='info_list'>
				<h4>{{book.info.title}}</h4>
				<div id='info_listp'>
					<p>{{book.info.author}}</p>
					<p>出版社：{{book.info.publisher}}</p>
					<p>出版日期：{{book.info.pub_dt}}</p>
					<p>語言：{{book.info.lang}}</p>
					<p>定價：<span id="price_list" style='color:red'>{{book.info.price_list}}</span> 元</p>
					<p>規格：{{book.info.spec}}</p>
					<p data-bookid='{{book.info.bookid}}'>ISBN：{{book.info.isbn}}</p>
				</div>
			</div>
		</div>
		
		
		<div id='price'>
			{{jsonstr}}
			<h4>紙本售價</h4>
			<svg id='bar'/>
		</div>				
	</div>	
{% endblock %}


